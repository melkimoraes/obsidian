```
SELECT ID FROM AD_INTGURU WHERE TRUNC(DTINT) = TRUNC(SYSDATE-3);

(SELECT NOTAS.NUNOTA
  FROM (SELECT NUNOTA, DTFATUR
          FROM AD_INTGURUAPRVNFSE
         WHERE DTFATURADO IS NULL
           AND NVL(CANCELADO, 'N') = 'N'
           AND NVL(QTDTNTFAT, 0) < 3
        UNION ALL
        SELECT NUNOTA, DTFATUR
          FROM AD_INTGURUAPRVNFE
         WHERE DTFATURADO IS NULL
           AND NVL(CANCELADO, 'N') = 'N'
           AND NVL(QTDTNTFAT, 0) < 3
         ORDER BY 1) NOTAS
 WHERE ROWNUM <= 1
   AND DTFATUR <= SYSDATE AND TO_CHAR(DTFATUR, 'MMYYYY') = TO_CHAR(SYSDATE, 'MMYYYY')
);

DELETE FROM TGFCAB WHERE TRUNC(DTNEG) = TRUNC(SYSDATE-1);

SELECT DISTINCT GREATEST(FLOOR(COUNT(1) / EXTRACT(DAY FROM LAST_DAY(SYSDATE))), 1) AS resultado
FROM AD_INTGURUAPRVNFSE
WHERE TO_CHAR(DTFATUR, 'MMYYYY') = TO_CHAR(SYSDATE, 'MMYYYY');

SELECT COUNT(1) 
FROM AD_INTGURUAPRVNFSE
WHERE TO_CHAR(DTFATUR, 'MMYYYY') = TO_CHAR(SYSDATE, 'MMYYYY');

SELECT SUM(QTD) AS QTDTOT FROM (
    SELECT COUNT(1) AS QTD FROM AD_INTGURUAPRVNFSE WHERE TRUNC(DTFATURADO) = TRUNC(SYSDATE)
    UNION ALL
   SELECT COUNT(1) AS QTD FROM AD_INTGURUAPRVNFE WHERE TRUNC(DTFATURADO) = TRUNC(SYSDATE)
)
;

UPDATE AD_INTGURUAPRVNFSE SET DTFATUR=SYSDATE WHERE TRUNC(DTFATUR)='12/09/23';

SELECT * FROM TGFCAB WHERE NUNOTA=17514;

SELECT GREATEST(
    FLOOR(COUNT(1) / EXTRACT(DAY FROM LAST_DAY(SYSDATE)) - EXTRACT(DAY FROM SYSDATE)),
    1
) AS resultado
FROM AD_INTGURUAPRVNFSE
WHERE TO_CHAR(DTFATUR, 'MMYYYY') = TO_CHAR(SYSDATE, 'MMYYYY')
AND DTFATURADO IS NULL;


//QUANDO DEU ERRO DE SERIE = 0, ELE GEROU O NRO UNICO POREM NAO SALVOU NA TELA DA INTEGRAÃ‡AO E NEM TINHA ITEM , ENTAO COM VALOR ZERADO!
SELECT COUNT(*) FROM TGFCAB WHERE AD_IDPED IS NOT NULL AND VLRNOTA = 0 AND NUNOTA IN (SELECT NUNOTA FROM AD_INTGURUAPRVNFE
UNION ALL
SELECT NUNOTA FROM AD_INTGURUAPRVNFSE)

DELETE FROM TGFCAB  WHERE AD_IDPED IS NOT NULL AND VLRNOTA = 0
DELETE FROM TGFCAB  WHERE AD_IDPED IS NOT NULL AND VLRNOTA = 0 AND ROWNUM <=300000



SELECT NUNOTA,'NFSE',PAGINA, IDPED FROM AD_INTGURUAPRVNFSE WHERE ID=33 AND NUNOTA NOT IN (SELECT NUNOTA FROM TGFCAB)
    UNION ALL
   SELECT NUNOTA, 'NFE',PAGINA, IDPED FROM AD_INTGURUAPRVNFE WHERE ID=33 AND NUNOTA NOT IN (SELECT NUNOTA FROM TGFCAB)
   
   --576 -> 647
   
   SELECT 
NUNOTA, 
LOGFAT, (SELECT CODTIPOPER FROM TGFCAB WHERE NUNOTA=AD_INTGURUAPRVNFE.NUNOTA) AS TOP, QTDTNTFAT FROM AD_INTGURUAPRVNFE WHERE QTDTNTFAT IS NOT NULL AND  NVL(FATURADO,'N') = 'N'


SELECT * FROM
(--SELECT NUNOTA,DTINIFATUR,DTFATURADO FROM AD_INTGURUAPRVNFSE WHERE TRUNC(DTFATURADO) = TRUNC(SYSDATE)
--UNION ALL
SELECT NUNOTA,DTINIFATUR,DTFATURADO FROM AD_INTGURUAPRVNFE WHERE TRUNC(DTFATURADO) = TRUNC(SYSDATE)) NOTAS
ORDER BY 2

```